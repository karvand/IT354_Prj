<html>
   <head>
   <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <title>Assignment3</title>
    <style>
		html, body, #map-canvas {
			height: 100%;
			margin: 0px;
			padding: 0px
		}
	
	</style>
	
    <script>
	   function findMyLocation() {
 	var location = document.getElementById("result");
 	location.innerHTML = "<p>Searching…</p>";
 	if (!navigator.geolocation) {
 		location.innerHTML = "<p>Geolocation is not supported by your browser</p>";
 		return;
 	}

 	function success(position) {
 		var lat = parseFloat(position.coords.latitude);
 		var lon = parseFloat(position.coords.longitude);
 		localStorage.setItem("latitude", lat);
 		localStorage.setItem("longitude", lon);
 		//location.innerHTML = '<p>Latitude: ' + lat + '° <br>Longitude: ' + lon + '°</p>';
 	};

 	function showError(error) {
 		switch (error.code) {
 		case error.PERMISSION_DENIED:
 			location.innerHTML = "Geolocation request terminated by user."
 			break;
 		case error.POSITION_UNAVAILABLE:
 			location.innerHTML = "Your location information is unavailable."
 			break;
 		case error.TIMEOUT:
 			location.innerHTML = "Request timed out."
 			break;
 		case error.UNKNOWN_ERROR:
 			location.innerHTML = "Unknown error."
 			break;
 		}
 	}
 	navigator.geolocation.getCurrentPosition(success, showError);
 }
 
    </script>
    
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>

    <script>
		var directionsDisplay;
		var directionsService = new google.maps.DirectionsService();
		var map;

		function initialize() {
			directionsDisplay = new google.maps.DirectionsRenderer();
			var delhi = new google.maps.LatLng(28.6139, 77.2090);
			var mapOptions = {
				zoom:5,
				center: delhi
			};
			map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
			directionsDisplay.setMap(map);
		}

		function calcRoute() {
			
			var lat = localStorage.getItem("latitude");
			var lon = localStorage.getItem("longitude");
			
		var dest = document.getElementById("zipcode").value;
			
			var latlng = new google.maps.LatLng(parseFloat(lat), parseFloat(lon));
			var sourceAddress = latlng;	
			var destination = dest;

			var request = {
				origin:sourceAddress,
				destination:destination,
				travelMode: google.maps.TravelMode.WALKING
			};
			
			directionsService.route(request, function(response, status) {
				if (status == google.maps.DirectionsStatus.OK) {
					directionsDisplay.setDirections(response);
				}
			});
		}
		
		google.maps.event.addDomListener(window, 'load', initialize);

	</script>
    
    </head>

<body onload="findMyLocation()">
	 <div data-role="main" class="ui-content">
            <form id="form1">
                <div class="ui-field-contain">
                    <label for="cityName"><b>Zipcode:</b></label> <input type="text" name="zipcode" data-clear-btn="true" id="zipcode">
                </div>

                    <input type="button" class="ui-btn ui-shadow" data-inline="true" id="submit" value="Get Location"  onclick="calcRoute()">
                    <br />
               <div id="result"></div>
               <div id="result1"></div>
<div id="map-canvas"></div>
            </form>
        </div>
	</body>
</html>